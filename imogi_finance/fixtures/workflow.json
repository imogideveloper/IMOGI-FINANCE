[
	{
		"actions": [
			{"action": "Submit", "allowed": "All"},
			{"action": "Approve", "allowed": "All"},
			{"action": "Reject", "allowed": "All"}
		],
		"docstatus": 0,
		"doctype": "Workflow",
		"document_type": "Expense Request",
		"is_active": 1,
		"module": "Imogi Finance",
		"name": "Expense Request Workflow",
		"workflow_name": "Expense Request Workflow",
		"notes": "Roles are intentionally broad; approval enforcement happens in ExpenseRequest.before_workflow_action based on the dynamically resolved route. Purchase Invoice creation is now done via the 'Create Purchase Invoice' button on the form (not a workflow action). Status 'Paid' is set automatically by Payment Entry on_submit hook. Auto-approve without approver is NOT allowed - Python enforces approval route configuration.",
		"override_status": 1,
		"states": [
			{"state": "Draft", "doc_status": "0", "allow_edit": "All"},
			{"state": "Pending Review", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Approved", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Rejected", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "PI Created", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Paid", "doc_status": "1", "allow_edit": "Expense Approver"}
		],
		"transitions": [
			{"action": "Submit", "allow_self_approval": 0, "allowed": "All", "state": "Draft", "next_state": "Pending Review"},
			{"action": "Approve", "allowed": "All", "state": "Pending Review", "next_state": "Pending Review", "condition": "((doc.get('current_approval_level') or 1) == 1 and (doc.get('level_2_user') or doc.get('level_3_user'))) or ((doc.get('current_approval_level') or 1) == 2 and doc.get('level_3_user'))"},
			{"action": "Approve", "allowed": "All", "state": "Pending Review", "next_state": "Approved", "condition": "not (((doc.get('current_approval_level') or 1) == 1 and (doc.get('level_2_user') or doc.get('level_3_user'))) or ((doc.get('current_approval_level') or 1) == 2 and doc.get('level_3_user')))"},
			{"action": "Reject", "allowed": "All", "state": "Pending Review", "next_state": "Rejected"}
		],
		"workflow_state_field": "workflow_state"
	},
	{
		"actions": [
			{"action": "Submit", "allowed": "All"},
			{"action": "Approve", "allowed": "All"},
			{"action": "Reject", "allowed": "All"}
		],
		"docstatus": 0,
		"doctype": "Workflow",
		"document_type": "Internal Charge Request",
		"is_active": 1,
		"module": "Imogi Finance",
		"name": "Internal Charge Request Workflow",
		"workflow_name": "Internal Charge Request Workflow",
		"notes": "Internal Charge Request approval workflow with line-level cost-centre approval routing. Roles are intentionally broad; approval enforcement happens in InternalChargeRequest.before_workflow_action based on dynamically resolved per-line routes. Each line in internal_charge_lines has its own approval status (Pending L1/L2/L3, Approved, Rejected) with target_cost_center-based route resolution.",
		"override_status": 1,
		"states": [
			{"state": "Draft", "doc_status": "0", "allow_edit": "All"},
			{"state": "Pending L1 Approval", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Pending L2 Approval", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Pending L3 Approval", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Approved", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Rejected", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Partially Approved", "doc_status": "1", "allow_edit": "Expense Approver"}
		],
		"transitions": [
			{"action": "Submit", "allow_self_approval": 0, "allowed": "All", "state": "Draft", "next_state": "Pending L1 Approval", "condition": "any(getattr(line, 'line_status') in ('Pending L1', 'Pending L2', 'Pending L3') for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Submit", "allow_self_approval": 0, "allowed": "All", "state": "Draft", "next_state": "Approved", "condition": "all(getattr(line, 'line_status') == 'Approved' for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Approve", "allowed": "All", "state": "Pending L1 Approval", "next_state": "Pending L1 Approval", "condition": "doc.get('status') == 'Pending Approval'"},
			{"action": "Approve", "allowed": "All", "state": "Pending L1 Approval", "next_state": "Pending L2 Approval", "condition": "any(getattr(line, 'line_status') == 'Pending L2' for line in doc.get('internal_charge_lines') or []) and not any(getattr(line, 'line_status') in ('Pending L1', 'Pending L3') for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Approve", "allowed": "All", "state": "Pending L2 Approval", "next_state": "Pending L2 Approval", "condition": "doc.get('status') == 'Pending Approval' and any(getattr(line, 'line_status') == 'Pending L2' for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Approve", "allowed": "All", "state": "Pending L2 Approval", "next_state": "Pending L3 Approval", "condition": "any(getattr(line, 'line_status') == 'Pending L3' for line in doc.get('internal_charge_lines') or []) and not any(getattr(line, 'line_status') in ('Pending L1', 'Pending L2') for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Approve", "allowed": "All", "state": "Pending L3 Approval", "next_state": "Pending L3 Approval", "condition": "doc.get('status') == 'Pending Approval' and any(getattr(line, 'line_status') == 'Pending L3' for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Approve", "allowed": "All", "state": "Pending L3 Approval", "next_state": "Approved", "condition": "all(getattr(line, 'line_status') == 'Approved' for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Approve", "allowed": "All", "state": "Pending L1 Approval", "next_state": "Partially Approved", "condition": "doc.get('status') == 'Partially Approved'"},
			{"action": "Approve", "allowed": "All", "state": "Pending L2 Approval", "next_state": "Partially Approved", "condition": "doc.get('status') == 'Partially Approved'"},
			{"action": "Approve", "allowed": "All", "state": "Pending L3 Approval", "next_state": "Partially Approved", "condition": "doc.get('status') == 'Partially Approved'"},
			{"action": "Approve", "allowed": "All", "state": "Partially Approved", "next_state": "Partially Approved", "condition": "doc.get('status') == 'Partially Approved'"},
			{"action": "Approve", "allowed": "All", "state": "Partially Approved", "next_state": "Approved", "condition": "all(getattr(line, 'line_status') == 'Approved' for line in doc.get('internal_charge_lines') or [])"},
			{"action": "Reject", "allowed": "All", "state": "Pending L1 Approval", "next_state": "Rejected"},
			{"action": "Reject", "allowed": "All", "state": "Pending L2 Approval", "next_state": "Rejected"},
			{"action": "Reject", "allowed": "All", "state": "Pending L3 Approval", "next_state": "Rejected"},
			{"action": "Reject", "allowed": "All", "state": "Partially Approved", "next_state": "Rejected"}
		],
		"workflow_state_field": "workflow_state"
	},
	{
		"actions": [
			{"action": "Submit", "allowed": "All"},
			{"action": "Approve", "allowed": "All"},
			{"action": "Reject", "allowed": "All"}
		],
		"docstatus": 0,
		"doctype": "Workflow",
		"document_type": "Branch Expense Request",
		"is_active": 1,
		"module": "Imogi Finance",
		"name": "Branch Expense Request Workflow",
		"workflow_name": "Branch Expense Request Workflow",
		"notes": "Multi-level approval flow based on branch. Roles are intentionally broad; approval enforcement happens in BranchExpenseRequest.before_workflow_action based on the dynamically resolved route. Auto-approve without approver is NOT allowed - Python enforces approval route configuration.",
		"override_status": 1,
		"states": [
			{"state": "Draft", "doc_status": "0", "allow_edit": "All"},
			{"state": "Pending Review", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Approved", "doc_status": "1", "allow_edit": "Expense Approver"},
			{"state": "Rejected", "doc_status": "1", "allow_edit": "Expense Approver"}
		],
		"transitions": [
			{"action": "Submit", "allow_self_approval": 0, "allowed": "All", "state": "Draft", "next_state": "Pending Review"},
			{"action": "Approve", "allowed": "All", "state": "Pending Review", "next_state": "Pending Review", "condition": "((doc.get('current_approval_level') or 1) == 1 and (doc.get('level_2_user') or doc.get('level_3_user'))) or ((doc.get('current_approval_level') or 1) == 2 and doc.get('level_3_user'))"},
			{"action": "Approve", "allowed": "All", "state": "Pending Review", "next_state": "Approved", "condition": "not (((doc.get('current_approval_level') or 1) == 1 and (doc.get('level_2_user') or doc.get('level_3_user'))) or ((doc.get('current_approval_level') or 1) == 2 and doc.get('level_3_user')))"},
			{"action": "Reject", "allowed": "All", "state": "Pending Review", "next_state": "Rejected"}
		],
		"workflow_state_field": "workflow_state"
	}
]
