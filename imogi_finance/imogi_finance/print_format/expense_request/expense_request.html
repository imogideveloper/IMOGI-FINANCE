<style>
  :root {
    --primary: #1a1a1a;
    --secondary: #525252;
    --border: #e5e5e5;
    --bg-light: #fafafa;
    --text: #404040;
    --text-light: #737373;
  }
  
  * {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    box-sizing: border-box;
  }
  
  body { font-size: 10px; color: var(--text); }
  
  .container { max-width: 800px; margin: 0 auto; padding: 16px; }
  
  /* Header */
  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 12px;
    border-bottom: 2px solid var(--primary);
    margin-bottom: 16px;
  }
  
  .header h1 {
    font-size: 14px;
    font-weight: 600;
    margin: 0;
    color: var(--primary);
  }
  
  .header .doc-id {
    font-size: 11px;
    color: var(--text-light);
  }
  
  .badge {
    display: inline-block;
    padding: 4px 12px;
    font-size: 9px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-radius: 4px;
    background: var(--bg-light);
    color: var(--secondary);
    border: 1px solid var(--border);
  }
  
  .badge-approved { background: var(--primary); color: white; border-color: var(--primary); }
  .badge-pending { background: #fef3c7; color: #92400e; border-color: #fde68a; }
  .badge-rejected { background: #fee2e2; color: #991b1b; border-color: #fecaca; }
  
  /* Grid */
  .grid { display: grid; gap: 16px; margin-bottom: 16px; }
  .grid-2 { grid-template-columns: repeat(2, 1fr); }
  
  /* Card */
  .card {
    background: white;
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 12px 16px;
  }
  
  .card-title {
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-light);
    margin: 0 0 10px 0;
    padding-bottom: 6px;
    border-bottom: 1px solid var(--border);
  }
  
  .row {
    display: flex;
    justify-content: space-between;
    padding: 4px 0;
    font-size: 10px;
  }
  
  .row-label { color: var(--text-light); }
  .row-value { font-weight: 500; color: var(--primary); text-align: right; }
  
  /* Table */
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 10px;
    margin-bottom: 16px;
  }
  
  thead { background: var(--primary); color: white; }
  
  th {
    padding: 8px 12px;
    text-align: left;
    font-weight: 600;
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  th.right { text-align: right; }
  
  td {
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
    color: var(--text);
  }
  
  td.right { text-align: right; font-weight: 500; }
  
  tr:nth-child(even) { background: var(--bg-light); }
  
  tfoot { background: var(--bg-light); border-top: 2px solid var(--primary); }
  tfoot th { color: var(--primary); }
  
  /* Notes */
  .notes {
    background: var(--bg-light);
    border-left: 3px solid var(--secondary);
    padding: 10px 14px;
    margin-bottom: 16px;
  }
  
  .notes-title {
    font-size: 9px;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-light);
    margin-bottom: 4px;
  }
  
  .notes-content {
    font-size: 10px;
    color: var(--text);
    line-height: 1.5;
  }
  
  /* Print */
  @media print {
    @page { margin: 12mm; }
    thead { background: var(--primary) !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .badge-approved { background: var(--primary) !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  }
</style>

<div class="container">
  <div class="header">
    <div>
      <h1>{{ _("Expense Request") }}</h1>
      <div class="doc-id">{{ doc.name }}</div>
    </div>
    {% set status_class = {
      'Approved': 'approved',
      'Pending Review': 'pending',
      'Rejected': 'rejected'
    }.get(doc.status, '') %}
    <span class="badge badge-{{ status_class }}">{{ doc.status or doc.workflow_state or 'Draft' }}</span>
  </div>

  <div class="grid grid-2">
    <div class="card">
      <div class="card-title">{{ _("Request Details") }}</div>
      <div class="row">
        <span class="row-label">{{ _("Date") }}</span>
        <span class="row-value">{{ frappe.utils.formatdate(doc.request_date) }}</span>
      </div>
      <div class="row">
        <span class="row-label">{{ _("Type") }}</span>
        <span class="row-value">{{ doc.request_type }}</span>
      </div>
      <div class="row">
        <span class="row-label">{{ _("Cost Center") }}</span>
        <span class="row-value">{{ doc.cost_center }}</span>
      </div>
      {% if doc.project %}
      <div class="row">
        <span class="row-label">{{ _("Project") }}</span>
        <span class="row-value">{{ doc.project }}</span>
      </div>
      {% endif %}
    </div>

    <div class="card">
      <div class="card-title">{{ _("Supplier") }}</div>
      <div class="row">
        <span class="row-label">{{ _("Name") }}</span>
        <span class="row-value">{{ doc.supplier }}</span>
      </div>
      {% if doc.supplier_invoice_no %}
      <div class="row">
        <span class="row-label">{{ _("Invoice No") }}</span>
        <span class="row-value">{{ doc.supplier_invoice_no }}</span>
      </div>
      {% endif %}
      {% if doc.supplier_invoice_date %}
      <div class="row">
        <span class="row-label">{{ _("Invoice Date") }}</span>
        <span class="row-value">{{ frappe.utils.formatdate(doc.supplier_invoice_date) }}</span>
      </div>
      {% endif %}
      <div class="row">
        <span class="row-label">{{ _("Currency") }}</span>
        <span class="row-value">{{ doc.currency }}</span>
      </div>
    </div>
  </div>

  {% if doc.description %}
  <div class="notes">
    <div class="notes-title">{{ _("Notes") }}</div>
    <div class="notes-content">{{ doc.description }}</div>
  </div>
  {% endif %}

  <table>
    <thead>
      <tr>
        <th style="width: 40%">{{ _("Account") }}</th>
        <th style="width: 30%">{{ _("Description") }}</th>
        <th class="right" style="width: 15%">{{ _("Amount") }}</th>
        <th class="right" style="width: 15%">{{ _("PPh Base") }}</th>
      </tr>
    </thead>
    <tbody>
      {% for row in doc.items %}
      <tr>
        <td>{{ row.expense_account }}</td>
        <td>{{ row.description or '-' }}</td>
        <td class="right">{{ frappe.utils.fmt_money(row.amount, currency=doc.currency) }}</td>
        <td class="right">{{ frappe.utils.fmt_money(row.pph_base_amount or 0, currency=doc.currency) if row.is_pph_applicable else '-' }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <th colspan="2" class="right">{{ _("Subtotal") }}</th>
        <th colspan="2" class="right">{{ frappe.utils.fmt_money(doc.amount, currency=doc.currency) }}</th>
      </tr>
    </tfoot>
  </table>

  <div class="grid grid-2">
    <div class="card">
      <div class="card-title">{{ _("Tax Summary") }}</div>
      <div class="row">
        <span class="row-label">{{ _("PPN") }}</span>
        <span class="row-value">{{ frappe.utils.fmt_money(doc.total_ppn or 0, currency=doc.currency) }}</span>
      </div>
      <div class="row">
        <span class="row-label">{{ _("PPh") }}</span>
        <span class="row-value" style="color: #dc2626;">-{{ frappe.utils.fmt_money(doc.total_pph or 0, currency=doc.currency) }}</span>
      </div>
      <div class="row" style="border-top: 1px solid var(--border); padding-top: 8px; margin-top: 4px;">
        <span class="row-label" style="font-weight: 600;">{{ _("Total") }}</span>
        <span class="row-value" style="font-size: 12px;">{{ frappe.utils.fmt_money(doc.total_amount or 0, currency=doc.currency) }}</span>
      </div>
    </div>

    <div class="card">
      <div class="card-title">{{ _("Approval") }}</div>
      {% if doc.level_1_user %}
      <div class="row">
        <span class="row-label">{{ _("Level 1") }}</span>
        <span class="row-value">{{ doc.level_1_user }}{% if doc.level_1_approved_on %} ✓{% endif %}</span>
      </div>
      {% endif %}
      {% if doc.level_2_user %}
      <div class="row">
        <span class="row-label">{{ _("Level 2") }}</span>
        <span class="row-value">{{ doc.level_2_user }}{% if doc.level_2_approved_on %} ✓{% endif %}</span>
      </div>
      {% endif %}
      {% if doc.level_3_user %}
      <div class="row">
        <span class="row-label">{{ _("Level 3") }}</span>
        <span class="row-value">{{ doc.level_3_user }}{% if doc.level_3_approved_on %} ✓{% endif %}</span>
      </div>
      {% endif %}
    </div>
  </div>
</div>