{
  "actions": [],
  "allow_rename": 0,
  "autoname": "format:BER-{YYYY}-{#####}",
  "creation": "",
  "docstatus": 0,
  "doctype": "DocType",
  "editable_grid": 0,
  "engine": "InnoDB",
  "field_order": [
    "primary_section",
    "posting_date",
    "request_type",
    "branch",
    "employee",
    "column_break_primary",
    "company",
    "requester",
    "fiscal_year",
    "purpose_section",
    "purpose",
    "items_section",
    "items",
    "totals_section",
    "total_amount",
    "amount",
    "items_totals_html",
    "column_break_totals",
    "expense_account",
    "expense_accounts",
    "currency",
    "taxes_section",
    "is_ppn_applicable",
    "ppn_template",
    "column_break_tax",
    "is_pph_applicable",
    "pph_type",
    "pph_base_amount",
    "ti_tax_invoice_section",
    "ti_tax_invoice_upload",
    "ti_tax_invoice_data_section",
    "ti_fp_no",
    "ti_fp_date",
    "ti_fp_npwp",
    "ti_fp_dpp",
    "ti_fp_ppn",
    "ti_fp_ppnbm",
    "ti_fp_ppn_type",
    "ti_verification_status",
    "ti_verification_notes",
    "ti_dpp_variance",
    "ti_ppn_variance",
    "ti_duplicate_flag",
    "ti_npwp_match",
    "budget_section",
    "budget_check_status",
    "column_break_budget",
    "budget_check_message",
    "approval_status_section",
    "status",
    "workflow_state",
    "approval_routing_section",
    "current_approval_level",
    "approval_setting",
    "column_break_approval",
    "approval_route_snapshot",
    "level_1_section",
    "level_1_user",
    "column_break_level_1",
    "level_1_role",
    "level_2_section",
    "level_2_user",
    "column_break_level_2",
    "level_2_role",
    "level_3_section",
    "level_3_user",
    "column_break_level_3",
    "level_3_role",
    "attachments_section",
    "attachments",
    "created_by_user",
    "submit_on"
  ],
  "fields": [
    {
      "fieldname": "primary_section",
      "fieldtype": "Section Break",
      "label": "üìã Request Information",
      "description": "Basic information about this expense request"
    },
    {
      "default": "Today",
      "fieldname": "posting_date",
      "fieldtype": "Date",
      "in_list_view": 1,
      "label": "üìÖ Posting Date",
      "reqd": 1,
      "bold": 1
    },
    {
      "bold": 1,
      "default": "Expense",
      "fieldname": "request_type",
      "fieldtype": "Select",
      "in_list_view": 1,
      "in_standard_filter": 1,
      "label": "üì¶ Request Type",
      "options": "Expense\nAsset",
      "reqd": 1
    },
    {
      "fieldname": "branch",
      "fieldtype": "Link",
      "in_list_view": 1,
      "in_standard_filter": 1,
      "label": "üè¢ Branch",
      "options": "Branch",
      "reqd": 1,
      "bold": 1
    },
    {
      "fieldname": "employee",
      "fieldtype": "Link",
      "label": "üë§ Employee",
      "options": "Employee",
      "description": "Employee requesting this expense"
    },
    {
      "fieldname": "column_break_primary",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "company",
      "fieldtype": "Link",
      "in_standard_filter": 1,
      "label": "üèõÔ∏è Company",
      "options": "Company",
      "reqd": 1
    },
    {
      "fieldname": "requester",
      "fieldtype": "Link",
      "in_standard_filter": 1,
      "label": "üë®‚Äçüíº Requester",
      "options": "User",
      "read_only": 1,
      "reqd": 1
    },
    {
      "fieldname": "fiscal_year",
      "fieldtype": "Link",
      "label": "üìÜ Fiscal Year",
      "options": "Fiscal Year",
      "reqd": 1
    },
    {
      "fieldname": "purpose_section",
      "fieldtype": "Section Break",
      "label": "üìù Purpose & Description"
    },
    {
      "fieldname": "purpose",
      "fieldtype": "Small Text",
      "label": "Purpose",
      "reqd": 1,
      "description": "Describe the purpose of this expense request"
    },
    {
      "fieldname": "items_section",
      "fieldtype": "Section Break",
      "label": "üì¶ Expense Items",
      "description": "Add line items for this expense request"
    },
    {
      "fieldname": "items",
      "fieldtype": "Table",
      "label": "Items",
      "options": "Branch Expense Request Item",
      "reqd": 1
    },
    {
      "fieldname": "totals_section",
      "fieldtype": "Section Break",
      "label": "üí∞ Totals & Summary"
    },
    {
      "bold": 1,
      "description": "Total amount of all items",
      "fieldname": "total_amount",
      "fieldtype": "Currency",
      "in_list_view": 1,
      "label": "üíµ Total Amount",
      "read_only": 1,
      "precision": 2
    },
    {
      "bold": 1,
      "description": "Sum of item amounts",
      "fieldname": "amount",
      "fieldtype": "Currency",
      "in_list_view": 1,
      "label": "Amount",
      "read_only": 1,
      "precision": 2
    },
    {
      "fieldname": "items_totals_html",
      "fieldtype": "HTML"
    },
    {
      "fieldname": "column_break_totals",
      "fieldtype": "Column Break"
    },
    {
      "description": "Auto-filled when all items share the same account",
      "fieldname": "expense_account",
      "fieldtype": "Link",
      "label": "Expense Account",
      "options": "Account",
      "read_only": 1
    },
    {
      "fieldname": "expense_accounts",
      "fieldtype": "Small Text",
      "label": "Expense Accounts",
      "read_only": 1,
      "hidden": 1,
      "no_copy": 1
    },
    {
      "fieldname": "currency",
      "fieldtype": "Link",
      "label": "Currency",
      "options": "Currency"
    },
    {
      "collapsible": 1,
      "fieldname": "taxes_section",
      "fieldtype": "Section Break",
      "label": "üßæ Tax Configuration (PPN & PPh)",
      "description": "Configure tax settings for this request"
    },
    {
      "default": "0",
      "fieldname": "is_ppn_applicable",
      "fieldtype": "Check",
      "label": "‚úì Apply PPN (VAT)",
      "description": "Check to apply Value Added Tax"
    },
    {
      "depends_on": "eval:doc.is_ppn_applicable==1",
      "fieldname": "ppn_template",
      "fieldtype": "Link",
      "label": "PPN Template",
      "mandatory_depends_on": "eval:doc.is_ppn_applicable==1",
      "options": "Purchase Taxes and Charges Template",
      "description": "Select the VAT template to apply"
    },
    {
      "fieldname": "column_break_tax",
      "fieldtype": "Column Break"
    },
    {
      "default": "0",
      "fieldname": "is_pph_applicable",
      "fieldtype": "Check",
      "label": "‚úì Apply PPh (Withholding Tax)",
      "description": "Check to apply withholding tax"
    },
    {
      "depends_on": "eval:doc.is_pph_applicable==1",
      "fieldname": "pph_type",
      "fieldtype": "Link",
      "label": "PPh Type",
      "options": "Tax Withholding Category",
      "description": "Select the withholding tax category"
    },
    {
      "depends_on": "eval:doc.is_pph_applicable==1",
      "fieldname": "pph_base_amount",
      "fieldtype": "Currency",
      "label": "PPh Base Amount",
      "precision": 2
    },
    {
      "fieldname": "ti_tax_invoice_section",
      "fieldtype": "Section Break",
      "label": "Tax Invoice (OCR)"
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_tax_invoice_upload",
      "fieldtype": "Link",
      "label": "Tax Invoice OCR Upload",
      "options": "Tax Invoice OCR Upload"
    },
    {
      "fieldname": "ti_tax_invoice_data_section",
      "fieldtype": "Section Break",
      "label": "Tax Invoice Data"
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_fp_no",
      "fieldtype": "Data",
      "label": "No Faktur Pajak",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_fp_date",
      "fieldtype": "Date",
      "label": "Tanggal Faktur Pajak",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_fp_npwp",
      "fieldtype": "Data",
      "label": "NPWP",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_fp_dpp",
      "fieldtype": "Currency",
      "label": "DPP",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_fp_ppn",
      "fieldtype": "Currency",
      "label": "PPN",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_fp_ppnbm",
      "fieldtype": "Currency",
      "label": "PPnBM",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "default": "Standard",
      "fieldname": "ti_fp_ppn_type",
      "fieldtype": "Select",
      "label": "PPN Type",
      "options": "Standard\nZero Rated\nExempt/Not PPN",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "default": "Needs Review",
      "fieldname": "ti_verification_status",
      "fieldtype": "Select",
      "label": "Tax Invoice Verification Status",
      "options": "Needs Review\nVerified\nRejected",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_verification_notes",
      "fieldtype": "Small Text",
      "label": "Tax Invoice Verification Notes",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_dpp_variance",
      "fieldtype": "Currency",
      "label": "DPP Variance",
      "read_only": 1,
      "description": "Difference between OCR DPP and Expected DPP (OCR - Expected). Can be negative or positive."
    },
    {
      "allow_on_submit": 1,
      "fieldname": "ti_ppn_variance",
      "fieldtype": "Currency",
      "label": "PPN Variance",
      "read_only": 1,
      "description": "Difference between OCR PPN and Expected PPN (OCR - Expected). Can be negative or positive."
    },
    {
      "allow_on_submit": 1,
      "depends_on": "eval:frappe.user.has_role('System Manager') || frappe.user.has_role('Accounts Manager')",
      "fieldname": "ti_duplicate_flag",
      "fieldtype": "Check",
      "label": "Duplicate Tax Invoice",
      "read_only": 1
    },
    {
      "allow_on_submit": 1,
      "depends_on": "eval:frappe.user.has_role('System Manager') || frappe.user.has_role('Accounts Manager')",
      "fieldname": "ti_npwp_match",
      "fieldtype": "Check",
      "label": "NPWP Match",
      "read_only": 1
    },
    {
      "collapsible": 1,
      "fieldname": "budget_section",
      "fieldtype": "Section Break",
      "label": "üíº Budget Control",
      "description": "Budget validation status and messages"
    },
    {
      "default": "Not Checked",
      "fieldname": "budget_check_status",
      "fieldtype": "Select",
      "in_list_view": 1,
      "label": "üìä Budget Status",
      "options": "Not Checked\nOK\nWarning\nOver Budget",
      "read_only": 1
    },
    {
      "fieldname": "column_break_budget",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "budget_check_message",
      "fieldtype": "Small Text",
      "label": "Budget Message",
      "read_only": 1
    },
    {
      "collapsible": 1,
      "fieldname": "approval_status_section",
      "fieldtype": "Section Break",
      "label": "üìä Status & Workflow",
      "description": "Current status and workflow information"
    },
    {
      "fieldname": "status",
      "fieldtype": "Data",
      "in_list_view": 1,
      "label": "Status",
      "read_only": 1
    },
    {
      "fieldname": "workflow_state",
      "fieldtype": "Link",
      "label": "Workflow State",
      "options": "Workflow State",
      "read_only": 1,
      "hidden": 1
    },
    {
      "collapsible": 1,
      "collapsible_depends_on": "eval:doc.docstatus==0",
      "fieldname": "approval_routing_section",
      "fieldtype": "Section Break",
      "label": "‚úÖ Approval Route Configuration",
      "description": "Approval levels and routing information"
    },
    {
      "default": "0",
      "description": "Current level in approval flow (0 = not started)",
      "fieldname": "current_approval_level",
      "fieldtype": "Int",
      "label": "Current Level",
      "read_only": 1
    },
    {
      "fieldname": "approval_setting",
      "fieldtype": "Link",
      "label": "Approval Setting Used",
      "options": "Branch Expense Approval Setting",
      "read_only": 1,
      "description": "The setting that determined this approval route"
    },
    {
      "fieldname": "column_break_approval",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "approval_route_snapshot",
      "fieldtype": "Long Text",
      "label": "Route Snapshot",
      "read_only": 1,
      "hidden": 1,
      "description": "JSON snapshot of the approval route"
    },
    {
      "collapsible": 1,
      "collapsible_depends_on": "eval:!doc.level_1_user",
      "fieldname": "level_1_section",
      "fieldtype": "Section Break",
      "label": "üë§ Level 1 Approver",
      "description": "First level approval"
    },
    {
      "fieldname": "level_1_user",
      "fieldtype": "Link",
      "label": "Approver",
      "options": "User",
      "read_only": 1
    },
    {
      "fieldname": "level_1_approved_on",
      "fieldtype": "Datetime",
      "label": "‚úÖ Approved On",
      "read_only": 1
    },
    {
      "fieldname": "level_1_rejected_on",
      "fieldtype": "Datetime",
      "label": "‚ùå Rejected On",
      "read_only": 1
    },
    {
      "fieldname": "column_break_level_1",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "level_1_role",
      "fieldtype": "Link",
      "label": "Role",
      "options": "Role",
      "read_only": 1
    },
    {
      "collapsible": 1,
      "collapsible_depends_on": "eval:!doc.level_2_user",
      "fieldname": "level_2_section",
      "fieldtype": "Section Break",
      "label": "üë• Level 2 Approver",
      "description": "Second level approval"
    },
    {
      "fieldname": "level_2_user",
      "fieldtype": "Link",
      "label": "Approver",
      "options": "User",
      "read_only": 1
    },
    {
      "fieldname": "level_2_approved_on",
      "fieldtype": "Datetime",
      "label": "‚úÖ Approved On",
      "read_only": 1
    },
    {
      "fieldname": "level_2_rejected_on",
      "fieldtype": "Datetime",
      "label": "‚ùå Rejected On",
      "read_only": 1
    },
    {
      "fieldname": "column_break_level_2",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "level_2_role",
      "fieldtype": "Link",
      "label": "Role",
      "options": "Role",
      "read_only": 1
    },
    {
      "collapsible": 1,
      "collapsible_depends_on": "eval:!doc.level_3_user",
      "fieldname": "level_3_section",
      "fieldtype": "Section Break",
      "label": "üëë Level 3 Approver",
      "description": "Third level approval (if required)"
    },
    {
      "fieldname": "level_3_user",
      "fieldtype": "Link",
      "label": "Approver",
      "options": "User",
      "read_only": 1
    },
    {
      "fieldname": "level_3_approved_on",
      "fieldtype": "Datetime",
      "label": "‚úÖ Approved On",
      "read_only": 1
    },
    {
      "fieldname": "level_3_rejected_on",
      "fieldtype": "Datetime",
      "label": "‚ùå Rejected On",
      "read_only": 1
    },
    {
      "fieldname": "column_break_level_3",
      "fieldtype": "Column Break"
    },
    {
      "fieldname": "level_3_role",
      "fieldtype": "Link",
      "label": "Role",
      "options": "Role",
      "read_only": 1
    },
    {
      "collapsible": 1,
      "fieldname": "attachments_section",
      "fieldtype": "Section Break",
      "label": "üìé Attachments",
      "description": "Supporting documents and files"
    },
    {
      "fieldname": "attachments",
      "fieldtype": "Table MultiSelect",
      "label": "Attachments",
      "options": "File"
    },
    {
      "fieldname": "created_by_user",
      "fieldtype": "Link",
      "label": "Created By",
      "options": "User",
      "read_only": 1,
      "no_copy": 1
    },
    {
      "fieldname": "submit_on",
      "fieldtype": "Datetime",
      "label": "Submit On",
      "read_only": 1,
      "no_copy": 1
    }
  ],
  "index_web_pages_for_search": 1,
  "is_submittable": 1,
  "istable": 0,
  "links": [
    {
      "group": "Invoice",
      "link_doctype": "Purchase Invoice",
      "link_fieldname": "branch_expense_request"
    },
    {
      "group": "Payment",
      "link_doctype": "Payment Entry",
      "link_fieldname": "branch_expense_request"
    }
  ],
  "module": "Imogi Finance",
  "name": "Branch Expense Request",
  "naming_rule": "By fieldname",
  "permissions": [
    {
      "create": 1,
      "delete": 1,
      "email": 1,
      "export": 1,
      "print": 1,
      "read": 1,
      "report": 1,
      "role": "Accounts User",
      "share": 1,
      "write": 1
    },
    {
      "cancel": 1,
      "create": 1,
      "delete": 1,
      "email": 1,
      "export": 1,
      "print": 1,
      "read": 1,
      "report": 1,
      "role": "Accounts Manager",
      "share": 1,
      "submit": 1,
      "write": 1
    },
    {
      "cancel": 1,
      "create": 1,
      "delete": 1,
      "email": 1,
      "export": 1,
      "print": 1,
      "read": 1,
      "report": 1,
      "role": "System Manager",
      "share": 1,
      "submit": 1,
      "write": 1
    }
  ],
  "quick_entry": 0,
  "show_name_in_global_search": 1,
  "sort_field": "modified",
  "sort_order": "DESC",
  "track_changes": 1
}
